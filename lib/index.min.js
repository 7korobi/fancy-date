!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.VuePetitStore=e():t.VuePetitStore=e()}(global,function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=3)}([function(t,e,n){"use strict";var r,i,o,u,s,a,c,l;r=n(1),o=function({name:t,params:e,query:n,hash:i},o,u){var s,a,c;for(s in u||(e=r.cloneDeep(e),n=r.cloneDeep(n)),a={name:t,params:e,query:n,hash:i},o)c=o[s],e[s]?e[s]=c:n[s]=c;return a},l=function(t,e,n){return function(r){switch(null!=r?r.constructor:void 0){case null:case void 0:case e:return n;case t:return r;default:return t(r)}}},s=function(t){return 1e3*a(t)},a=function(t){var e;return e=0,t.replace(/(\d+)(.)|0/g,function(t,n,r){if(n=Number(n))return e+=function(){switch(r){case"s":return n;case"m":return 60*n;case"h":return 3600*n;case"d":return 86400*n;case"w":return 604800*n;case"y":return 31536e3*n;default:throw new Error(`${timestr} at ${n}${r}`)}}()}),e},c=function(t,e="0s"){var n,r,o;return t=s(t),e=s(e),e-=i,o=new Date-0,{last_at:((r=parseInt((o-e)/t))+0)*t+e,write_at:o,next_at:n=(r+1)*t+e,timeout:n-o,now_idx:r,timezone:u,since:t,gap:e}},t.exports={relative_to:o,to_sec:a,to_msec:s,to_tempo:c,types:{[Number]:{to_str:l(String,NaN,""),by_str:l(Number,"",NaN),by_url:l(Number,"",NaN)},[String]:{to_str:l(String,null,""),by_str:l(String,"",null),by_url:l(String,"",null)},[Array]:{to_str:JSON.stringify,by_str:JSON.parse,by_url:l(Array,null,null)},[Object]:{to_str:JSON.stringify,by_str:JSON.parse}}},i=s("9hour"),u=-i},function(t,e){t.exports=require("lodash")},function(t,e){t.exports=require("memory-orm")},function(t,e,n){"use strict";t.exports={...n(0),...n(4),...n(6),...n(8),...n(9),...n(11)}},function(t,e,n){"use strict";var r,i,o,u,s;i=n(1),r=n(5),({types:s,relative_to:o}=n(0));try{u="__vue-localstorage-test__",r.set(u,u,{expres:"1M"}),r.remove(u),window.localStorage.setItem(u,u),window.localStorage.removeItem(u),window.sessionStorage.setItem(u,u),window.sessionStorage.removeItem(u),history||function(){throw new Error("can't use history API.")}()}catch(t){t,console.warn("Local storage not supported by this browser")}t.exports={replaceState:function(t){var e,n;return e=`${t}_default`,n=`${t}_type`,{created:function(){return this[e]=i.get(this,t),this[n]=s[this[e].constructor]},mounted:function(){var r;return r=this.$route.params[t]||this.$route.query[t],null==(r=this[n].by_url(r))&&(r=this[e]),this[t]=r},beforeRouteUpdate:function(r,i,o){var u;return o(),u=r.params[t]||r.query[t],null==(u=this[n].by_url(u))&&(u=this[e]),this[t]=u},watch:{[t]:function(e){var n,r;return({location:r,href:n}=this.$router.resolve(o(this.$route,{[t]:e},!0))),history.replaceState(null,null,n)}}}},pushState:function(t){var e,n;return e=`${t}_default`,n=`${t}_type`,{created:function(){return this[e]=i.get(this,t),this[n]=s[this[e].constructor]},mounted:function(){var r;return r=this.$route.params[t]||this.$route.query[t],null==(r=this[n].by_url(r))&&(r=this[e]),this[t]=r},beforeRouteUpdate:function(r,i,o){var u;return o(),u=r.params[t]||r.query[t],null==(u=this[n].by_url(u))&&(u=this[e]),this[t]=u},watch:{[t]:function(e){var n,r;return({location:r,href:n}=this.$router.resolve(o(this.$route,{[t]:e},!0))),history.pushState(null,null,n)}}}},sessionStorage:function(t){var e,n;return e=`${t}_default`,n=`${t}_type`,{created:function(){return this[e]=i.get(this,t),this[n]=s[this[e].constructor]},mounted:function(){var e;if(null!=(e=window.sessionStorage.getItem(t)))return this[t]=this[n].by_str(e)},watch:{[t]:function(e){var r;return null!=e?(r=this[n].to_str(e),window.sessionStorage.setItem(t,r)):window.sessionStorage.removeItem(t)}}}},localStorage:function(t){var e,n,r;return e=`${t}_default`,n=`${t}_handle`,r=`${t}_type`,{created:function(){return this[e]=i.get(this,t),this[r]=s[this[e].constructor]},mounted:function(){var e;return null!=(e=window.localStorage.getItem(t))&&(this[t]=this[r].by_str(e)),this[n]=(({key:e,newVal:n})=>{if(e===t)return this[t]=this[r].by_str(n)}),window.addEventListener("storage",this[n])},beforeDestroy:function(){return window.removeEventListener("storage",this[n])},watch:{[t]:function(e){var n;return null!=e?(n=this[r].to_str(e),window.localStorage.setItem(t,n)):window.localStorage.removeItem(t)}}}},cookie:function(t,e={expires:"1M"}){var n,o;return n=`${t}_default`,o=`${t}_type`,{created:function(){return this[n]=i.get(this,t),this[o]=s[this[n].constructor]},mounted:function(){var e;if(null!=(e=r.get(t)))return this[t]=this[o].by_str(e)},watch:{[t]:function(n){var i;return null!=n?(i=this[o].to_str(n),r.set(t,i,e)):r.remove(t)}}}}}},function(t,e){t.exports=require("tiny-cookie")},function(t,e,n){"use strict";var r,i,o,u,s;r=n(2),"undefined"!=typeof window&&null!==window&&(i=n(7)),o=function(){var t;return(t=i.firestore()).settings({}),t},s=function(t,e){var n;return n=function(){},function(r){return n(),n=r&&this[t]?(console.log("join",r),this[t].onSnapshot(e.bind(this))):function(){}}},u=function(t,e,n,i,{del:u,add:a,snap:c,shot:l}){var d,f,h,p,v,m,_,w,y,g,b,x;return p=`${t}_default`,g=`${t}_query`,b=`${t}_snap`,f=`${t}_chk`,y=`${t}_path`,_=`${t}_join`,d=`${t}_add`,v=`${t}_del`,[x,w]=n&&i?[f,g]:[y,b],m=s(w,l),h={_firestore:o,[y]:e,[b]:function(){if(this[y])return c.call(this,this[y])}},n&&i&&Object.assign(h,{[f]:n,[g]:function(){if(this[f]&&this[b])return i.call(this,this[b])}}),{data:function(){return{step:r.State.step}},mounted:function(){return this[p]=this[t],this[_](this[x])},beforeDestroy:function(){return this[_](void 0)},methods:{[_]:m,[d]:a,[v]:u},computed:h,watch:{[x]:m}}},t.exports={firestore_models:function(t,e,n,i){var o,s;return s=`${t}_snap`,o=t.slice(0,-1),u(t,e,n,i,{del:function(t){var e;if(t)return null!=(e=this[s])?e.doc(t).delete():void 0},add:function(t){var e,n;if(({_id:e}=t),e)return null!=(n=this[s])?n.doc(e).set(t,{merge:!0}):void 0},snap:function(t){return this._firestore.collection(t)},shot:function(t){return t.docChanges().forEach(({newIndex:t,oldIndex:e,type:n,doc:i})=>{switch(n){case"added":case"modified":return r.Set[o].add(i.data());case"removed":return r.Set[o].remove(i.id)}})}})},firestore_model:function(t,e){var n,i;return i=`${t}_snap`,n=t,u(t,e,null,null,{del:function(){var t;return null!=(t=this[i])?t.delete():void 0},add:function(t){var e;return null!=(e=this[i])?e.set(t,{merge:!0}):void 0},snap:function(t){return this._firestore.doc(t)},shot:function(t){var e;return(e=t.data())?r.Set[n].add(e):r.Set[n].remove(t.id)}})},firestore_collection:function(t,e,n,r){var i;return i=`${t}_snap`,u(t,e,n,r,{del:function(t){var e;if(t)return null!=(e=this[i])?e.doc(t).delete():void 0},add:function(t){var e,n;if(({_id:e}=t),e)return null!=(n=this[i])?n.doc(e).set(t,{merge:!0}):void 0},snap:function(t){return this._firestore.collection(t)},shot:function(e){return e.docChanges().forEach(({newIndex:e,oldIndex:n,type:r,doc:i})=>{switch(r){case"added":case"modified":return this[t][i.id]=i.data();case"removed":return delete this[t][i.id]}})}})},firestore_doc:function(t,e){var n,r;return r=`${t}_snap`,n=`${t}_default`,u(t,e,null,null,{del:function(){var t;return null!=(t=this[r])?t.delete():void 0},add:function(t){var e;return null!=(e=this[r])?e.set(t,{merge:!0}):void 0},snap:function(t){return this._firestore.doc(t)},shot:function(e){return this[t]=e.exists?e.data():this[n]}})}}},function(t,e){t.exports=require("firebase")},function(t,e,n){"use strict";var r;r=n(1),t.exports={vuex_read:function(t,e){var n,i;return i=t.split("."),n={},e.map(function(t){var e;return e=[...i.slice(0),t].join("."),n[t]={get:function(){return r.get(this.$store.state,e)}}}),{computed:n}},vuex:function(t,e){var n,i;return i=t.split("."),n={},e.forEach(function(t){var e,o,u;return o=`${i[0]}/update`,e=[...i.slice(0),t].join("."),u=[...i.slice(1),t].join("."),n[t]={get:function(){return r.get(this.$store.state,e)},set:function(t){var e;return e=r.set({},u,t),this.$store.commit(o,e)}}}),{computed:n}}}},function(t,e,n){"use strict";function r(t,e,n,r,i,o,u){try{var s=t[o](u),a=s.value}catch(t){return void n(t)}s.done?e(a):Promise.resolve(a).then(r,i)}function i(t){return function(){var e=this,n=arguments;return new Promise(function(i,o){var u=t.apply(e,n);function s(t){r(u,i,o,s,a,"next",t)}function a(t){r(u,i,o,s,a,"throw",t)}s(void 0)})}}var o,u,s,a,c,l,d,f,h;u=n(2),o=n(10).default,({to_tempo:f}=n(0)),a={},c=l=!1,"undefined"!=typeof document&&null!==document&&(s=new o("giji")).version(1).stores({meta:"&idx",data:"&idx"}),(d=function(t){return{data:function(){return{step:u.State.step}},mounted:function(){return this.timers={},window.addEventListener("offline",this._waitwake),window.addEventListener("online",this._waitwake),document.addEventListener("visibilitychange",this._waitwake),this._waitwake()},destroyed:function(){var t,e,n,r;for(t in window.removeEventListener("offline",this._waitwake),window.removeEventListener("online",this._waitwake),document.removeEventListener("visibilitychange",this._waitwake),n=[],e=this.timers)r=e[t],n.push(clearTimeout(r));return n},methods:{get_by_network:function(){var e,n,r;for(e in n=this.timers)r=n[e],clearTimeout(r);return t.call(this).map(([t,e])=>{var n;return n=[t,e].join("&"),s.meta.delete(n),s.data.delete(n),a[n]=0}),this._waitwake()},_waitwake:(e=i(function*(){var e,n,r,i,o,u=this;if(c=window.navigator.onLine,l="hidden"!==document.visibilityState,c&&l)return n=t.call(this),yield Promise.all(n.map(function([t,e]){return u.$store.dispatch(t,{id:e,name:t,timers:u.timers})}));for(e in i=[],r=this.timers)o=r[e],i.push(clearTimeout(o));return i}),function(){return e.apply(this,arguments)})}};var e}).cache=function(t,e,n){return function({dispatch:e,state:r,commit:o,rootState:c},{id:l,name:h,timers:p}){var v,m,_,w;return _=n(l),v=[h,l].join("&"),w=i(function*(){var e,n,r,o,c,w,y,g,b,x;if(({last_at:o,write_at:g,next_at:w,timeout:y}=f(t)),r=function(){var e;return e=new Date-g,console.log({timestr:t,idx:v,wait:e,url:null})},b=i(function*(){var e,n;return({pack:e}=yield s.data.get(v)),u.State.store(e),n=new Date-g,console.log({timestr:t,idx:v,wait:n,url:"(LF)"})}),e=function(){return b.apply(this,arguments)},x=i(function*(){var e,n;return e=yield d._api[h](_,l),yield s.data.put({idx:v,pack:e}),n=new Date-g,console.log({timestr:t,idx:v,wait:n,url:_})}),n=function(){return x.apply(this,arguments)},g<a[v])r();else switch(0<a[v]||(c=yield s.meta.get(v)),!1){case!(g<(null!=c?c.next_at:void 0)):yield e();break;case!(0<(null!=c?c.next_at:void 0)):yield e(),yield n();break;default:yield n(),s.meta.put({idx:v,next_at:w})}if(a[v]=w,y<2147483647)return p[_]=setTimeout(m,y)}),(m=function(){return w.apply(this,arguments)})()}},d.caches=function(t,e){var n,r;for(r in e)n=e[r],e[r]=d.cache(t,r,n);return e},d._api={fetch:(h=i(function*(t,e){var n,r;return r=yield fetch(t),n=yield r.json(),u.State.transaction(function(){return e(n)})}),function(t,e){return h.apply(this,arguments)})},d.api=function(t){return Object.assign(d._api,t)},t.exports={poll:d}},function(t,e){t.exports=require("dexie")},function(t,e,n){"use strict";var r;({Query:r}=n(2)),t.exports={path_by:function(t="idx",e){var n,i;return(n={})[i=`${t}_a`]={get:function(){return this[t].split("-")}},e.forEach(function(t,e){var o,u;if(t)return u=`${t}s`,n[o=`${t}_id`]={get:function(){if(e<this[i].length)return this[i].slice(0,+e+1||9e9).join("-")}},n[t]={get:function(){return r[u].find(this[o])}}}),{computed:n}}}}])});
//# sourceMappingURL=index.min.js.map